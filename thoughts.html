<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shailyâ€™s Thoughts</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0; padding: 20px;
      font-family: 'Quicksand', sans-serif;
      background-color: #ffe6f0;
      color: #d6336c;
      min-height: 100vh;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-weight: 600;
    }
    .thought {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 8px rgb(214 51 108 / 0.2);
    }
    .thought .datetime {
      font-size: 0.9em;
      color: #a3003a;
      margin-bottom: 8px;
      font-weight: 600;
    }
    .thought .grievance {
      font-size: 1.2em;
      margin-bottom: 12px;
    }
    .thought .comfort {
      font-style: italic;
      font-weight: 600;
      color: #ff66b2;
    }
    .loading {
      text-align: center;
      font-size: 1.2em;
      margin-top: 50px;
      color: #a3003a;
      font-weight: 600;
    }
    .error {
      text-align: center;
      color: #ff0033;
      font-weight: 700;
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <h1>Shailyâ€™s Thoughts</h1>
  <div id="thoughts-container">
    <div class="loading">Loading thoughts...</div>
  </div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbys0UDA2iLXen4KaKkOc7p7oorZlRY4-Jki2MhQ81mkuWPJqfmriv0_n5bVG2jvyW7opA/exec';

    async function fetchThoughts() {
      const container = document.getElementById('thoughts-container');
      try {
        // Fetch all data from the script - we expect JSON array of objects
        const response = await fetch(scriptURL + '?action=fetch');
        if (!response.ok) throw new Error('Network response was not ok');
        const data = await response.json();

        if (!Array.isArray(data) || data.length === 0) {
          container.innerHTML = '<p class="loading">No thoughts submitted yet.</p>';
          return;
        }

        // Clear loading
        container.innerHTML = '';

        // Sort by datetime descending (latest first)
        data.sort((a,b) => new Date(b.datetime) - new Date(a.datetime));

        data.forEach(item => {
          const thoughtDiv = document.createElement('div');
          thoughtDiv.className = 'thought';

          thoughtDiv.innerHTML = `
            <div class="datetime">${new Date(item.datetime).toLocaleString()}</div>
            <div class="grievance">ðŸ’¬ ${item.grievance}</div>
            <div class="comfort">Comfort: ${item.comfort}</div>
          `;

          container.appendChild(thoughtDiv);
        });
      } catch (error) {
        container.innerHTML = `<p class="error">Failed to load thoughts. Please try again later.</p>`;
        console.error('Error fetching thoughts:', error);
      }
    }

    // Call fetch on page load
    fetchThoughts();
  </script>
</body>
</html>
